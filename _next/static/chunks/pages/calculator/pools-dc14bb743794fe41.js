(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5827],{6010:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/calculator/pools",function(){return o(8668)}])},8668:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return H}});var l,n,a=o(92228),r=o(79570),c=o(62942),i=o(47314),s=o(11324),u=o(64095),d=o(1473),p=o(89011),h=o(69987),k=o(5685),m=o(28388),S=o(72558),_=o(16405);(l=n||(n={})).SET_KEY="SET_KEY",l.SET_POOLS_CACHE="SET_POOLS_CACHE",l.SET_FAVORITE_POOL_IDS="SET_FAVORITE_POOL_IDS",l.INIT_FAVORITE_POOL_IDS="INIT_FAVORITE_POOL_IDS";let I=(e,t)=>{switch(t.type){case n.SET_KEY:return{...e,key:t.payload};case n.SET_POOLS_CACHE:return{...e,poolsCache:{...e.poolsCache,[t.payload.key]:t.payload.pools}};case n.SET_FAVORITE_POOL_IDS:{let o={...e,favoritePoolIds:{...e.favoritePoolIds,[t.payload.key]:[...t.payload.poolIds]}};return localStorage.setItem(f,JSON.stringify(o.favoritePoolIds)),o}case n.INIT_FAVORITE_POOL_IDS:return{...e,favoritePoolIds:t.payload}}},f="poolOverview_favoritePoolIds",v={key:null,poolsCache:{},tokensCache:{},favoritePoolIds:{}},T=_.createContext(void 0),y=e=>{let{children:t}=e,[o,l]=_.useReducer(I,v);return(0,r.jsx)(T.Provider,{value:{state:o,dispatch:l},children:t})},O=()=>{let e=_.useContext(T);if(void 0===e)throw Error("usePoolContext must be used within a PoolContextProvider");return e},P=Object.values(k.nU),E=e=>"".concat(e," Pool").concat(1!==e?"s":""),g=()=>{let{amm:e,networkId:t}=(0,c.L)(),[o,l]=(0,_.useState)(!1),[a,i]=(0,_.useState)([]),[d,S]=(0,_.useState)(k.OT[0]),I=O(),v=(0,u.A7)(e),T=v?e:k.bl[u.Rr],y=v?t:(0,p.$D)(k.rW[T.name][0]),g=I.state.key||"".concat(T.name,"-").concat(y),L=g.split("-")[0],b=(0,p.pp)(Number(g.split("-")[1])),x=I.state.favoritePoolIds||{};(0,_.useEffect)(()=>{I.dispatch({type:n.INIT_FAVORITE_POOL_IDS,payload:JSON.parse(localStorage.getItem(f)||"{}")})},[]),(0,_.useEffect)(()=>{var e;let t=!0;if(I.state.poolsCache[g]){i(I.state.poolsCache[g]);return}l(!0),(0,m.getLogger)().info("PoolOverview.GetPools.Start",{selectedDex:L,selectedNetwork:b});let{totalValueLockedUSD_gte:o,volumeUSD_gte:a}=null!==(e=u.vT[b])&&void 0!==e?e:u._m;return(0,s.d2)(u.Gh[L][b],o,a).then(e=>{let{pools:o}=e;if(t){let e=D(o);i(e),l(!1),(0,m.getLogger)().info("PoolOverview.GetPools.Success"),I.dispatch({type:n.SET_POOLS_CACHE,payload:{key:g,pools:e}})}}).catch(e=>{t&&((0,m.getLogger)().error("PoolOverview.GetPools.Error",{error:e.toString()}),l(!1))}),()=>{t=!1,l(!1)}},[I.state.key,g]);let C=(0,_.useMemo)(()=>{if(o||!a||!(a.length>0))return[];{let e=a.reduce((e,t)=>{var o,l;let a=null==x?void 0:null===(o=x[g])||void 0===o?void 0:o.includes(t.poolId),r=null!==(l=x[g])&&void 0!==l?l:[];return t.timeframeData[1].volume>h.DkL&&e.push({...w(t,b,L,d,a),onSelect:()=>{I.dispatch({type:n.SET_FAVORITE_POOL_IDS,payload:{key:"".concat(L,"-").concat((0,p.$D)(b)),poolIds:a?r.filter(e=>e!==t.poolId):[...r,t.poolId]}})}}),e},[]);return e}},[o,a,x,d]),N=(0,_.useMemo)(()=>Object.entries(x).reduce((e,t)=>{var o;let[l,a]=t,[r,c]=l.split("-"),i=null===(o=I.state.poolsCache[l])||void 0===o?void 0:o.reduce((e,t)=>{if(a.includes(t.poolId)){let o={...w(t,(0,p.pp)(Number(c)),r,d,!0),onSelect:()=>{I.dispatch({type:n.SET_FAVORITE_POOL_IDS,payload:{key:l,poolIds:x[l].filter(e=>e!==t.poolId)}})}};e.push(o)}return e},[]);return e=i?[...e,...i]:e},[]),[x,g,a,d]),V=null==C?void 0:C.length,A=null==N?void 0:N.length,j=(0,k.AQ)(d);return(0,r.jsxs)(k.tu,{gap:"3xl",children:[(0,r.jsx)(k.XB,{list:k.rW,selectedExchange:L,setSelectedExchange:(e,t)=>{I.dispatch({type:n.SET_KEY,payload:"".concat(e,"-").concat((0,p.$D)(t))})},selectedNetwork:b,setSelectedNetwork:(e,t)=>{I.dispatch({type:n.SET_KEY,payload:"".concat(e,"-").concat((0,p.$D)(t))})}}),(0,r.jsx)(k.iA,{title:"Favorite Pools",headers:A>0?j:void 0,content:N,rowComponent:k.jA,tag:E(A),emptyState:k.cd,columnWidths:P,style:{width:1080}}),(0,r.jsx)(k.iA,{title:"Top Pools",loading:o,headers:j,content:C,rowComponent:k.jA,tag:!o&&a&&E(V),additionalComponent:(0,r.jsx)(k.nv,{selected:d,onSelect:S,disabled:o}),columnWidths:P,emptyState:k.ok,style:{width:1080}})]})},w=(e,t,o,l,n)=>{let{apy:a,priceVolatilityPercentage:c,dailyVolumePerTVL:s,fees:d,volume:m}=e.timeframeData[l],S=(0,p.$D)(t),{Icon:_}=k.bl[o],{Icon:I}=(0,k.bt)(t);return{poolId:e.poolId,token0:{ticker:e.token0.symbol,Icon:(0,i.Y)(e.token0.id,e.token0.symbol,S)},token1:{ticker:e.token1.symbol,Icon:(0,i.Y)(e.token1.id,e.token1.symbol,S)},feeTier:"".concat(100*(0,u.yF)(e.feeTier),"%"),dexIcon:(0,r.jsx)(_,{}),chainIcon:(0,r.jsx)(I,{}),feeAPY:"".concat(a.toFixed(2),"%"),risk:e.risk,priceVolatility:"".concat(c.toFixed(2),"%"),totalValueLockedUSD:"".concat((0,h.oSm)(e.totalValueLockedUSD,2)),fee24h:"".concat((0,h.oSm)(d,2)),volume24h:"".concat((0,h.oSm)(m,2)),volumePerTVL:"".concat((100*s).toFixed(2),"%"),isFavorite:n,url:b(t,o,e.poolId),calcUrl:x(o,t,e.token0,e.token1,e.feeTier)}},D=e=>{let t=e.map((e,t)=>{let o=Number(e.totalValueLockedUSD),l=k.OT.reduce((t,l)=>{let n=e.poolDayData.slice(0,l),a=n.reduce((e,t)=>e+Number(t.volumeUSD),0),r=a*(0,u.yF)(e.feeTier),c=n.reduce((e,t)=>(e.high=Math.max(e.high,Number(t.high)),e.low=Math.min(e.low,Number(t.low)),e),{high:-1/0,low:1/0}),i=100*((c.high-c.low)/c.high),s=L(e,i,a/l),d=100*(365*s)/1e3,p={volume:a,dailyVolumePerTVL:a/l/o,fees:r,priceVolatilityPercentage:i,apy:isNaN(d)?0:d};return t[l]=p,t},{}),n={lowPoolTVL:o<1e7,lowPoolVolume:l[1].dailyVolumePerTVL<.1,highPriceVolatility:l[1].priceVolatilityPercentage>10,lowToken0TVL:1e7>Number(e.token0.totalValueLockedUSD),lowToken0PoolCount:e.token0.poolCount<5,lowToken1TVL:1e7>Number(e.token1.totalValueLockedUSD),lowToken1PoolCount:e.token1.poolCount<5},a=Object.values(n).filter(e=>!0===e).length,r=k.gQ.SAFE;return a>=1&&(r=k.gQ.LOW_RISK),a>=4&&(r=k.gQ.HIGH_RISK),{key:t.toString(),poolId:e.id,feeTier:e.feeTier,token0:e.token0,token1:e.token1,totalValueLockedUSD:o,timeframeData:l,risk:r}});return t},L=(e,t,o)=>{var l,n;let a=(0,d.gr)(Number(e.tick),e.token0.decimals,e.token1.decimals),r=a-a*t/100,c=a+a*t/100,i=Number(e.token1.tokenDayData[0].priceUSD),s=Number(e.token0.tokenDayData[0].priceUSD),{amount0:u,amount1:p}=(0,d.tk)(a,r,c,i,s,1e3),h=(0,d.D9)(a,r,c,u,p,Number((null===(l=e.token0)||void 0===l?void 0:l.decimals)||18),Number((null===(n=e.token1)||void 0===n?void 0:n.decimals)||18)),k=new S.Z(e.liquidity),m=e.feeTier,_=a>=r&&a<=c?(0,d.uQ)(h,k,o,m):0;return _},b=(e,t,o)=>{switch(t){case k.Rw.Uniswap:return"https://app.uniswap.org/explore/pools/".concat((0,k.bt)(e).name.split(" ")[0].toLowerCase(),"/").concat(o);case k.Rw.PancakeSwap:let l="https://pancakeswap.finance/liquidity/pool";switch(e){case k.HL.BNB:return"".concat(l,"/bsc/").concat(o);case k.HL.ETHEREUM:return"".concat(l,"/eth/").concat(o);default:return}default:return}},x=(e,t,o,l,n)=>{let a=(0,p.$D)(t),r=(0,u.Y8)(o,a),c=(0,u.Y8)(l,a);return"".concat("/calculator","?calc_dex=").concat(e,"&calc_network=").concat(t,"&tokenA=").concat(r.address,"-").concat(r.isNative,"&tokenB=").concat(c.address,"-").concat(c.isNative,"&feeTier=").concat(n)};var C=o(80631),N=o(38547),V=o(58694);function A(){let e=(0,a.Z)(["\n  max-width: 1080px;\n  margin-top: 24px;\n  align-items: flex-start;\n"]);return A=function(){return e},e}function j(){let e=(0,a.Z)(["\n  text-align: left;\n  color: ",";\n"]);return j=function(){return e},e}let F=(0,V.ZP)(C._z).withConfig({componentId:"sc-8af3b0d-0"})(A()),R=(0,V.ZP)(N.H1).withConfig({componentId:"sc-8af3b0d-1"})(j(),e=>{let{theme:t}=e;return t.colors.global.text.T1}),U=()=>(0,r.jsx)(F,{children:(0,r.jsxs)(y,{children:[(0,r.jsx)(R,{children:"Pool Overview"}),(0,r.jsx)(g,{})]})});var H=U}},function(e){e.O(0,[9458,1629,1324,2888,179],function(){return e(e.s=6010)}),_N_E=e.O()}]);
//# sourceMappingURL=pools-dc14bb743794fe41.js.map